local player = game.Players.LocalPlayer
local VirtualUser = game:GetService("VirtualUser")
local StarterGui = game:GetService("StarterGui")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- Send Notification
StarterGui:SetCore("SendNotification", {
    Title = "Anti-AFK & Anti Cherry Pick",
    Text = "Script Activated",
    Duration = 5
})

-- Prevent AFK Kick
player.Idled:Connect(function()
    VirtualUser:CaptureController()
    VirtualUser:ClickButton2(Vector2.new())
end)

-- Disable AFK Check in UI
local function disableAFKCheck()
    local function disableScriptInGui(gui)
        local afkCheckScript = gui:FindFirstChild("AFK.Check")
        if afkCheckScript and afkCheckScript:IsA("LocalScript") then
            afkCheckScript.Disabled = true
            print("AFK.Check script in", gui.Name, "is disabled.")
        end
    end

    local starterGuiAFKUi = StarterGui:FindFirstChild("AFK.Ui")
    if starterGuiAFKUi then
        disableScriptInGui(starterGuiAFKUi)
    end

    local playerGuiAFKUi = player.PlayerGui:FindFirstChild("AFK.Ui")
    if playerGuiAFKUi then
        disableScriptInGui(playerGuiAFKUi)
    end
end

disableAFKCheck()

-- Anti Cherry Pick System
local GameValues = ReplicatedStorage:WaitForChild("GameValues")
local WarmupFinished = GameValues:WaitForChild("WarmupFinished")

local PLACE_ID = 14269621394  -- Change this to match your game place

if game.PlaceId ~= PLACE_ID then
    return
end

local function moveToPosition(position)
    local character = player.Character or player.CharacterAdded:Wait()
    local humanoid = character:WaitForChild("Humanoid")

    humanoid:MoveTo(position)
    humanoid.MoveToFinished:Wait()
end

local function checkAndMove()
    while true do
        if WarmupFinished.Value == true then
            print("Warmup Finished, Enabling Anti Cherry Pick")

            wait(95)  -- Wait before enforcing movement

            local originalPosition = Vector3.new(-23, 4, -416) -- Set a return position
            moveToPosition(originalPosition)

            wait(25)

            local humanoidRootPart = player.Character:WaitForChild("HumanoidRootPart")
            local currentPosition = humanoidRootPart.Position

            -- If the player moved away, force return
            if (currentPosition - originalPosition).Magnitude > 1 then
                wait(32)
                moveToPosition(originalPosition)
            end
        end
        wait(1)
    end
end

checkAndMove()
